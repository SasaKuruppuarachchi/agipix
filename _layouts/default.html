<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="{{ site.description }}">
  <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
  <header class="site-header"{% if page.title_bottom_gap %} style="--title-bottom-gap: {{ page.title_bottom_gap }}"{% endif %}>
    <div class="container">
      <!-- <h1 class="site-title glow-text"><a href="{{ '' | relative_url }}" style="color: inherit; text-decoration: none;">AGIPIX</a></h1> -->
      <!-- <p class="site-subtitle">{{ site.description }}</p> -->
    </div>
    <!-- Banner layers: background image and glowing text -->
    <div class="banner-image" aria-hidden="true"></div>
    <div class="banner-text" aria-hidden="true"></div>
  </header>

  <nav class="site-nav">
    <div class="nav-container">
      <button class="nav-toggle" aria-label="Toggle navigation" aria-controls="primary-navigation" aria-expanded="false">
        <span class="nav-toggle-bar"></span>
        <span class="nav-toggle-bar"></span>
        <span class="nav-toggle-bar"></span>
      </button>
      <div class="nav-links" id="primary-navigation">
        <a href="{{ '' | relative_url }}" class="nav-link">Home</a>
        <a href="{{ '/docs' | relative_url }}" class="nav-link">Docs Hub</a>
        <a href="{{ '/docs/sim/index' | relative_url }}" class="nav-link">Sim</a>
        <a href="{{ '/docs/real/index' | relative_url }}" class="nav-link">Real</a>
        <a href="{{ '/docs/autonomy/index' | relative_url }}" class="nav-link">Autonomy</a>
        <a href="{{ '/bom.html' | relative_url }}" class="nav-link">BOM</a>
        <a href="{{ site.github.repository_url }}" class="nav-link" target="_blank">GitHub</a>
      </div>
    </div>
  </nav>

  <script>
    (function(){
      const siteNav = document.querySelector('.site-nav');
      const toggle = document.querySelector('.nav-toggle');
      const links = document.getElementById('primary-navigation');
      if (!siteNav || !toggle || !links) return;
      toggle.addEventListener('click', () => {
        const isOpen = siteNav.getAttribute('data-open') === 'true';
        siteNav.setAttribute('data-open', String(!isOpen));
        toggle.setAttribute('aria-expanded', String(!isOpen));
      });
    })();
  </script>

  <main class="container">
    {{ content }}
  </main>

  <footer class="site-footer">
    <div class="footer-content">
      <div class="footer-section">
        <h3>BibTeX (ref.bib)</h3>
        <p>
          <button id="copy-bib-btn" class="btn btn-secondary" type="button">Copy</button>
        </p>
        <pre id="bibtex-block"><code class="language-bibtex" id="bibtex-code">Loading ref.bib…</code></pre>
      </div>
      <div class="footer-section">
        <h3>Contact Authors</h3>
        <p><a href="https://sasakuruppuarachchi.github.io/" target="_blank" rel="noopener">Sasanka Kuruppu Arachchige</a> — sasa.kuruppuarachchi@gmail.com</p>
        <p><a href="https://webpages.tuni.fi/vision/public_pages/JoniKamarainen/" target="_blank" rel="noopener">Joni Kämäräinen</a> — joni.kamarainen@tuni.fi</p>
      </div>
      <div class="footer-section">
        <h3>Acknowledgment</h3>
        <p>Agipix is supported by RAICAM, MSCA HORIZON EU.</p>
      </div>

      <div class="footer-section">
        <p>© 2025 Agipix Project | <a href="{{ site.github.repository_url }}/blob/main/LICENSE">License</a></p>
      </div>
    </div>
  </footer>
  <script>
    (function(){
      const bibUrl = "{{ '/ref.bib' | relative_url }}";
      const codeEl = document.getElementById('bibtex-code');
      const copyBtn = document.getElementById('copy-bib-btn');

      if (codeEl) {
        fetch(bibUrl, { cache: 'no-cache' })
          .then(resp => resp.ok ? resp.text() : Promise.reject(resp.status))
          .then(text => { codeEl.textContent = (text || '').trim(); })
          .catch(() => { codeEl.textContent = 'Could not load ref.bib'; });
      }

      if (copyBtn && codeEl) {
        copyBtn.addEventListener('click', () => {
          const data = codeEl.textContent || '';
          const onCopied = () => { copyBtn.textContent = 'Copied'; setTimeout(() => (copyBtn.textContent = 'Copy'), 1500); };

          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(data).then(onCopied).catch(() => {});
          } else {
            // Fallback: select and copy
            try {
              const range = document.createRange();
              range.selectNodeContents(codeEl);
              const sel = window.getSelection();
              sel.removeAllRanges();
              sel.addRange(range);
              document.execCommand('copy');
              sel.removeAllRanges();
              onCopied();
            } catch (e) {}
          }
        });
      }
    })();
  </script>
</body>
</html>
